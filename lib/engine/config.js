/**
 * 紫微斗数配置文件
 * 包含权重、常量和映射定义
 */

// 宫位名称
export const PALACE_NAMES = ["疾厄", "财帛", "子女", "夫妻", "兄弟", "命宫", "父母", "福德", "田宅", "官禄", "仆役", "迁移"];

// 星曜集合
export const MAJOR_14 = new Set(["紫微", "天机", "太阳", "武曲", "天同", "廉贞", "天府", "太阴", "贪狼", "巨门", "天相", "天梁", "七杀", "破军"]);
export const SOFT = new Set(["左辅", "右弼", "天魁", "天钺", "文昌", "文曲"]);
export const TOUGH = new Set(["擎羊", "陀罗", "火星", "铃星", "地空", "地劫"]);
export const FLOWER = new Set(["红鸾", "天喜", "天姚", "咸池"]);
export const HELPER = new Set(["解神", "年解", "月解"]);
export const POS_ADJ = new Set(["天德", "月德", "天福", "三台", "八座", "恩光", "天贵", "天官", "台辅", "封诰", "龙池", "凤阁", "天才", "天厨"]);
export const NEG_ADJ = new Set(["天空", "旬空", "空亡", "天刑", "阴煞", "天哭", "破碎", "小耗", "大耗", "伏兵", "官符", "病符"]);

// 星曜简义
export const STAR_BRIEF = {
  "紫微":"权柄统筹","天机":"机变策划","太阳":"光彩名誉","武曲":"财务执行","天同":"温和求稳","廉贞":"制度边界","天府":"守成聚财","太阴":"温润细腻","贪狼":"社交尝鲜","巨门":"口才是非","天相":"平衡协调","天梁":"庇护正直","七杀":"决断攻坚","破军":"变革重来",
  "左辅":"强势援助","右弼":"温柔后援","天魁":"领导贵气","天钺":"方案解题","文昌":"文书逻辑","文曲":"文艺表达",
  "擎羊":"刚猛冲突","陀罗":"顽固拖拽","火星":"急躁爆点","铃星":"惊扰敏感","地空":"理想落空","地劫":"破耗错失",
  "禄存":"俸禄保底","天马":"机动奔波",
  "红鸾":"端庄亲和","天喜":"活泼喜庆","天姚":"表现魅力","咸池":"风情吸引"
};

// 星曜权重配置
export const BASE_WEIGHTS = {
  "紫微": 2.5, "天相": 2.0, "天府": 2.0, "太阳": 1.8, "太阴": 1.6,
  "天同": 1.6, "武曲": 1.5, "天机": 1.4, "天梁": 1.4, "巨门": 0.8,
  "七杀": 0.8, "贪狼": 0.6, "廉贞": 0.6, "破军": 0.5,
  "左辅": 1.2, "右弼": 1.2, "天魁": 1.2, "天钺": 1.2, "文昌": 1.2, "文曲": 1.2,
  "擎羊": -1.5, "陀罗": -1.5, "火星": -1.5, "铃星": -1.5, "地空": -1.5, "地劫": -1.5,
  "禄存": 1.4, "天马": 0.8
};

// 四化权重
export const MUTAGEN_WEIGHTS = { "禄": 1.2, "权": 0.8, "科": 0.8, "忌": -1.6 };

// 动态权重
export const FLOWER_WEIGHT = 0.8;
export const HELPER_WEIGHT = 0.6;
export const POS_ADJ_WEIGHT = 0.4;
export const NEG_ADJ_WEIGHT = -0.6;

// 三方四正权重
export const TRI_WEIGHTS = { "self": 0.7, "opp": 0.1, "tri1": 0.1, "tri2": 0.1 };

// 归一化参数
export const NORM_PARAMS = { "center": 0.0, "spread": 8.0 };

// 亮度映射
export const BRIGHTNESS_ALIASES = {
  "得地": "得", "利益": "利", "平和": "平", "不得地": "不", "不得": "不", "落陷": "陷", "庙旺": "庙"
};

export const BRIGHTNESS_POS_MULT = {
  "庙": 1.30, "旺": 1.20, "得": 1.08, "利": 1.03, "平": 1.00, "不": 0.60, "陷": -1.20
};

export const BRIGHTNESS_NEG_MULT = {
  "庙": 0.85, "旺": 0.90, "得": 0.95, "利": 0.98, "平": 1.00, "不": 1.10, "陷": 1.30
};

// 评分档位
export const SYNASTRY_BINS = [
  ["相克", 0, 35], ["相冲", 35, 50], ["中性", 50, 60],
  ["相合", 60, 75], ["强合", 75, 85], ["共振", 85, 101]
];

// 档位建议文案
export const BUCKET_TONE = {
  "相克": "冲突偏多，需规避关键决策。",
  "相冲": "摩擦与互补并存，建立互动规则更重要。",
  "中性": "可做但别硬上，围绕具体主题再看组合。",
  "相合": "和谐互补，适合推进关键事项。",
  "强合": "高度匹配，建议升阶合作/关系。",
  "共振": "强同频，适合关键节点与共创。"
};

// 宫位建议配置
export const PALACE_ADVICE = {
  "夫妻": {
    "pos": ["提升沟通频率，规划共同时间与仪式感。"],
    "neg": ["建立冲突降噪规则：冷静期/复盘/沟通边界。"],
    "neu": ["从小议题协作，逐步验证相处节奏。"]
  },
  "官禄": {
    "pos": ["明确分工与节奏，设立周迭代和月度复盘。"],
    "neg": ["明确权限与决策门槛，避免职责拉扯。"],
    "neu": ["小范围试合作，逐步扩大责任。"]
  },
  "财帛": {
    "pos": ["共拟预算与分配规则，设收益复盘。"],
    "neg": ["设止损线与上限，避免冲动投入。"],
    "neu": ["从小额试点开始校验资金规则。"]
  },
  "田宅": {
    "pos": ["可共建家庭资产/居住规划，明确产权边界。"],
    "neg": ["保持财产独立，避免高杠杆与长期绑定。"],
    "neu": ["从短期居住/资产安排试运行。"]
  },
  "父母": {
    "pos": ["建立与权威的正向沟通与汇报机制。"],
    "neg": ["隔离外部权威压力，内部先达成一致。"],
    "neu": ["约定对外口径，降低外部干扰。"]
  },
  "子女": {
    "pos": ["推进项目/育成计划，明确里程碑与质控。"],
    "neg": ["明确职责归属与质量门槛，避免扯皮。"],
    "neu": ["小步快跑，短周期评审与纠偏。"]
  },
  "迁移": {
    "pos": ["安排旅行/差旅/岗位轮换，增强共同体验。"],
    "neg": ["减少大幅变动，必要时先做短期尝试。"],
    "neu": ["短期流动尝试，评估适配度。"]
  },
  "疾厄": {
    "pos": ["建立健康习惯与风险缓释清单。"],
    "neg": ["避免高风险安排，设置预警与兜底。"],
    "neu": ["制定基础作息与体检提醒。"]
  },
  "兄弟": {
    "pos": ["利用社交与协同网络，扩大协作半径。"],
    "neg": ["避免圈层冲突，划清人际边界。"],
    "neu": ["小群试协作，逐步扩圈。"]
  },
  "福德": {
    "pos": ["强化价值观同频：共享语言与仪式。"],
    "neg": ["避免价值观争论，聚焦具体议题。"],
    "neu": ["围绕共同兴趣开展低风险活动。"]
  },
  "命宫": {
    "pos": ["鼓励优势表达，彼此赋能。"],
    "neg": ["尊重个体空间与界限，降低消耗。"],
    "neu": ["观察互动边界，逐步加深了解。"]
  }
};

// 星曜类型中文映射
export function starsTypeMapping(type) {
  const stars = {
    'major': '主星',
    'soft': '吉星',
    'tough': '煞星',
    'adjective': '杂耀',
    'flower': '桃花',
    'helper': '解神',
    'lucun': '禄存',
    'tianma': '天马'
  };
  return stars[type] || type;
}

// 运限类型中文映射
export function scopeMapping(scope) {
  const scopes = {
    'daily': '流日星耀',
    'monthly': '流月星耀',
    'yearly': '流年星耀',
    'decadal': '大限星耀',
    'origin': '本命星耀'
  };
  return scopes[scope] || scope;
}

export const MUTAGENS_MAPPING = ['禄', '权', '科', '忌'];
